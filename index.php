<?php
include_once "header.php";
?>

		<section class="table-module-1">
			<div class="container">
				<div class="row module-1-title">
					
				</div>
				<div class="row">
					<div class="col-md-12 search-result">
						<table class="table tablelayout display nowrap" cellspacing="0" width="100%" id="mytable">


						</table>
					</div>
				</div>
			</div>
		</section>

		<div class="landing-info-wrapper">
			<section id="how" class="how">
				<div class="container">
					<div class="row">
						<div class="col-sm-12 text-center">
							<h1 class="tr" key="how1">
								
							</h1>
							<span class="header-desc tr" key="how2">							
								
							</span>			
						</div>
					</div>
					<div class="row">
						<div class="col-sm-3 text-center">
							<img src="img/search_s.png" class="">
							<span class="roboto-black tr" key="how3">
								
							</span>
							<span class="tr" key="how4">
								
							</span>
						</div>
						<div class="col-sm-3 text-center">
							<img src="img/sunset_s.png" class="">
							<span class="roboto-black tr" key="how5">
								
							</span>
							<span class="tr" key="how6"">
								
							</span>
						</div>
						<div class="col-sm-3 text-center">
							<img src="img/result_s.png" class="">
							<span class="roboto-black tr" key="how7">
								
							</span>
							<span class="tr" key="how8"">
								
							</span>
						</div>
						<div class="col-sm-3 text-center">
							<img src="img/mosque_s.png" class="">
							<span class="roboto-black tr" key="how9">
								
							</span>
							<span class="tr" key="how10">
								
							</span>
						</div>
					</div>
				</div>
			</section>

			<div class="row hr-wrapper">
				<div class="col-xs-10 col-xs-offset-1">
					<hr />
				</div>
			</div>

			<section class="why">
				<div class="container">
					<div class="row">
						<div class="col-sm-12 text-center">
							<h1 class="tr" key="why1">
								
							</h1>	
						</div>
					</div>
					<div class="row">
						<div class="col-sm-4 text-center">
							<img src="img/stopwatch_s.png" class="">
							<span class="roboto-black tr" key="why2">
								
							</span>
						</div>
						<div class="col-sm-4 text-center">
							<img src="img/flash_s.png" class="">
							<span class="roboto-black tr" key="why3">
								
							</span>
						</div>
						<div class="col-sm-4 text-center">
							<img src="img/ringing_s.png" class="">
							<span class="roboto-black tr" key="why4">
								
							</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-4 text-center">
							<img src="img/info_s.png" class="">
							<span class="roboto-black tr" key="why5">
								
							</span>
						</div>
						<div class="col-sm-4 text-center">
							<img src="img/coordinate_s.png" class="">
							<span class="roboto-black tr" key="why6">
								
							</span>
						</div>
						<div class="col-sm-4 text-center">
							<img src="img/track_s.png" class="">
							<span class="roboto-black tr" key="why7">
								
							</span>
						</div>
					</div>
				</div>
			</section>

			<div class="row hr-wrapper">
				<div class="col-xs-10 col-xs-offset-1">
					<hr />
				</div>
			</div>

			<section class="join">
				<div class="container">
					<div class="row">
						<div class="col-sm-5 text-center">
							<img src="img\badge.png" class="center-block img-responsive max-270">
						</div>
						<div class="col-sm-7">
							<h1 class="tr" key="join1">
								
							</h1>
							<span class="header-desc tr" key="join2">
								
							</span>
							<span class="tr" key="join3">
								
							</span>
							<span class="tr" key="join4">
								
							</span>
							<span class="text-center">
								<a href="registration.php" target="_self" class="btn btn-primary tr" key="join5">

								</a>
							</span>
						</div>
					</div>
				</div>
			</section>

			<div class="row hr-wrapper">
				<div class="col-xs-10 col-xs-offset-1">
					<hr />
				</div>
			</div>

			<section id="contact" class="contact">
				<div class="container">
					<div class="row">
						<div class="col-md-12 text-center">
							<h1 class="tr" key="contact1">
								
							</h1>
							<span class="header-desc tr" key="contact2">							
								
							</span>			
						</div>
						<div class="col-sm-3 col-sm-offset-3 text-center">
							<a href="javascript:;" class="link">
								<span class="tr" key="contact3">
									
								</span>
							</a>
						</div>
						<div class="col-sm-3 text-center">
							<a href="javascript:;" class="link">
								<span class="tr" key="contact4">
									
								</span>
							</a>
						</div>
						<div class="clearfix"></div>
						<div class="col-md-12 text-center">
							<span class="hidden-xs hidden-sm time tr" key="contact5">							
								
							</span>
							<span class="hidden-md hidden-lg time tr" key="contact10">							
								
							</span>
							<span class="hidden-md hidden-lg time tr" key="contact11">							
								
							</span>
							<span class="normal tr" key="contact6">
								
							</span>	
						</div>
						<!-- <div class="col-xs-12">
							<div class="btn-group btn-group-justified group">
								<div class="col-xs-6 col-sm-4 col-sm-offset-2 col-md-4 col-md-offset-2 col-lg-4 col-lg-offset-2">
									<a href="javascript:;" class="btn btn-block btn-default btn-history tr" data-target="#modal1" key="contact7">
										
									</a>
								</div>
								<div class="col-xs-6 col-sm-4 col-md-4 col-lg-4">
									<a href="javascript:;" class="btn btn-block btn-default btn-history">								
										<span class="hide-400 tr" key="contact8">
											
										</span>
										<span class="show-400 tr" key="contact9">
											
										</span>
									</a>
								</div>

							</div>
						</div> -->
					</div>
				</div>
			</section>
		</div>

<?php
include_once "pop_up.php";
include_once "popup_login.php";
include_once "footer.php";
?>



		<script src="js/jquery-3.2.1.js"></script>		
		<script src="js/jquery-ui.js"></script>
		<script src="js/tether.js"></script>
		<script src="js/jquery.validate.js"></script>
		<script src="js/bootstrap-3.3.7.js"></script>
		<script src="js/moment.js"></script>
		<script src="js/jquery.selectBoxIt.js?v=1.0001"></script>
		<script src="js/bootstrap-datepicker.js"></script>
		<script src="js/datatables.js"></script>
		<!-- <script src="js/less.js?v=1.0002"></script> -->
		<script src="js/lang.js?v=1.0015"></script>

		<script>
			window.fbAsyncInit = function() {
			    // FB JavaScript SDK configuration and setup
			    FB.init({
			      appId      : '291760927941775', // FB App ID
			      cookie     : true,  // enable cookies to allow the server to access the session
			      xfbml      : true,  // parse social plugins on this page
			      version    : 'v2.8' // use graph api version 2.8
			    });
			    
			    // Check whether the user already logged in
			    FB.getLoginStatus(function(response) {
			        if (response.status === 'connected') {
			            //display user data
			            //getFbUserData();
			        }
			    });
			};

			// Load the JavaScript SDK asynchronously
			(function(d, s, id) {
			    var js, fjs = d.getElementsByTagName(s)[0];
			    if (d.getElementById(id)) return;
			    js = d.createElement(s); js.id = id;
			    js.src = "//connect.facebook.net/en_US/sdk.js";
			    fjs.parentNode.insertBefore(js, fjs);
			}(document, 'script', 'facebook-jssdk'));

			// Facebook login with JavaScript SDK
			function fbLogin() {
			    FB.login(function (response) {
			        if (response.authResponse) {
			            // Get and display the user profile data
			            getFbUserData();
			        } else {
			            document.getElementById('status').innerHTML = 'User cancelled login or did not fully authorize.';
			        }
			    }, {scope: 'email'});
			}

			// Fetch the user profile data from facebook
			function getFbUserData(){
			    FB.api('/me', {locale: 'en_US', fields: 'id,first_name,last_name,email,link,gender,locale,picture'},
			    function (response) {
			        document.getElementById('fbLink').setAttribute("onclick","fbLogout()");
			        document.getElementById('fbLink').innerHTML = 'Logout from Facebook';
			        document.getElementById('status').innerHTML = 'Thanks for logging in, ' + response.first_name + '!';
			        document.getElementById('userData').innerHTML = '<p><b>FB ID:</b> '+response.id+'</p><p><b>Name:</b> '+response.first_name+' '+response.last_name+'</p><p><b>Email:</b> '+response.email+'</p><p><b>Gender:</b> '+response.gender+'</p><p><b>Locale:</b> '+response.locale+'</p><p><b>Picture:</b> <img src="'+response.picture.data.url+'"/></p><p><b>FB Profile:</b> <a target="_blank" href="'+response.link+'">click to view profile</a></p>';
			        
			        // Save user data
			        saveUserData(response);
			    });
			}

			// Logout from facebook
			function fbLogout() {
			    FB.logout(function() {
			        document.getElementById('fbLink').setAttribute("onclick","fbLogin()");
			        document.getElementById('fbLink').innerHTML = '<img src="fblogin.png"/>';
			        document.getElementById('userData').innerHTML = '';
			        document.getElementById('status').innerHTML = 'You have successfully logout from Facebook.';
			    });
			}

			// Save user data to the database
			function saveUserData(userData){
				// console.log(JSON.stringify(userData));
				// canceling = $.ajax({
    //                 type:"POST",
    //                 url: "ajax_fb.php",
    //                 data: {oauth_provider:'facebook',userData: JSON.stringify(userData)},
    //                 contentType: "application/json",	                    	
    //                 cache:true,
    //                 success:function(data){
    //             		console.log("Data: "+data);

    //                 }
    //             })

//                 $.ajax({
//     url: url,
//     type: "POST",
//     data: JSON.stringify(data),
//     contentType: "application/json",
//     complete: callback
// });
				// "&userID="+userID


			    $.post('ajax_fb.php', {oauth_provider:'facebook',userData: JSON.stringify(userData)}, function(data){
			    	console.log("Data: "+data);
			    	return true;
			    });
			}
		</script>

		<script>
			$(document).ready(function(){
				
				var screenHeight, navHeight, dashHeight, keyHeight, pentagonWidth, userTypeID, lang, state, area, oTable;
				var fixedNavHeight = 50;
				var paddingTop = 20;
				var padding = 40;

				lang = $(".lang").attr("toggle");

				function initWindowsChange(){
					screenHeight 	= $(window).height();
					navHeight		= $(".navbar").height();
					dashHeight		= screenHeight - navHeight;
					dashHeight		= screenHeight - fixedNavHeight;
					pentagonWidth	= $(".personal").width();
					borderWidth 	= $(".personal-border").width();
					dashboardPentagonWidth 	= $(".dashboard-pentagon").width();
					dashboardBorderWidth 	= $(".personal-dashboard-border-border").width();
					
					windowsChange();
				}

				function windowsChange(){
					if($(".dashboard-header").hasClass("init")){
						$(".dashboard-header").css("height",dashHeight);
					}else{
						keyHeight = $(".key-function").outerHeight();
						$(".dashboard-header").css({"min-height":keyHeight+paddingTop,"height":keyHeight+paddingTop});
						$(".dashboard-desc").css("display","none");
					}

					if(screenHeight<550){
						$(".dashboard-mobile").css("top","10%");
					}else{
						$(".dashboard-mobile").css("top","15%");
					}

					if(pentagonWidth!=0){
						$(".personal").css("height",pentagonWidth);	
					}
					$(".personal-border").css("height",borderWidth);
					$(".dashboard-pentagon").css("height",dashboardPentagonWidth+padding);	
					$(".personal-dashboard-border-border").css("height",dashboardBorderWidth);
				}

				function destroySession(){
                    $.ajax({
                        url: "ajax_destroy.php",
                        type: "post",
                        data: "sure=1", //send a value to make sure we want to destroy it.
                        success: function(data){
                            setTimeout(function() {
                                window.location.href = "index.php";
                            }, 50);
                        }
                    });
                }
                

                $(".book-ustaz-link").click(function(){
					// window.location.href = "services.php?service=bookustaz";
					window.location.href = "bookustaz.php";
				});

				$(".search-job-link").click(function(){
					// window.location.href = "services.php?service=searchjob";
					window.location.href = "searchpostjob.php";
				});


                $(".nav-logout").click(function() {
                    destroySession();
                });

				state 	= <?php echo json_encode($_SESSION["state"]); ?>;
				area 	= <?php echo json_encode($_SESSION["area"]); ?>;

				$(".go-to").click(function() {
					// On-page links
					var target = $(this).attr("go-to");
					// target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
					// Does a scroll target exist?
					if (target.length) {
						// Only prevent default if animation is actually gonna happen
						event.preventDefault();
						$('html, body').animate({
						  scrollTop: $("."+target).offset().top
						}, 1000, function() {
						  // Callback after animation
						  // Must change focus!
						  
						});
					}
				});

				$(".book-ustaz-link").click(function(){
					// window.location.href = "services.php?service=bookustaz";
					window.location.href = "bookustaz.php";
				});

				$(".search-job-link").click(function(){
					// window.location.href = "services.php?service=searchjob";
					window.location.href = "searchpostjob.php";
				});
				

	            $(function(){
					var selectBox = $("select").selectBoxIt();
					$("select.state").selectBoxIt({ autoWidth: false });
					$("select.state").empty();


					$("select.state").data("selectBox-selectBoxIt").add({ value: "", text: "Negeri"});

					for (var i = 0, len = state.length; i < len; i++) {
						$("select.state").data("selectBox-selectBoxIt").add({ value: state[i]["state_id"], text: state[i]["state"]});
					}

					$("select.area").selectBoxIt({ autoWidth: false });
					$("select.area").empty();
					$("select.area").data("selectBox-selectBoxIt").add({ value: "", text: "Daerah" });
				});


				$(".state").change(function (){
					
					var state = $(this).val();

					$("select.area").selectBoxIt();
					$("select.area").empty();
					$("select.area").data("selectBox-selectBoxIt").add({ value: "", text: "Daerah" });

					for (var i = 0, len = area.length; i < len; i++) {
						if(area[i]["state_id"]==state){
							$("select.area").data("selectBox-selectBoxIt").add({ value: area[i]["area_id"], text: area[i]["area"]});
						}
					}

				});

				$(function () {
	                $(".from").datepicker({
	                    format: "dd-mm-yyyy",
					    todayBtn: "linked",
					    clearBtn: true,
					    forceParse: false,
					    startDate: "01-01-1960",
					    endDate: "01-01-2099",
					    todayHighlight: true
	                }).on("changeDate", function(selected){
				        startDate = new Date(selected.date.valueOf());
				        startDate.setDate(startDate.getDate(new Date(selected.date.valueOf())));
				        $(".to").datepicker("setStartDate", startDate);
				    }); 
	            });

				$(function () {
	                $(".to").datepicker({
	                    format: "dd-mm-yyyy",
					    todayBtn: "linked",
					    clearBtn: true,
					    forceParse: false,
					    startDate: "01-01-1960",
    					endDate: "01-01-2099",
					    todayHighlight: true
	                }).on("changeDate", function(selected){
				        FromEndDate = new Date(selected.date.valueOf());
				        FromEndDate.setDate(FromEndDate.getDate(new Date(selected.date.valueOf())));
				        $(".from").datepicker("setEndDate", FromEndDate);
				    });  
	            });

	            $(".kulliyyah-finder").validate({
	                rules:
	                {
	                   // "state": {
	                   //   required:true, valueNotEquals: ""
	                   // },
	                   // "area": {
	                   //   required: true
	                   // },
	                   // "from": {
	                   //   required:true
	                   // },
	                   // "to": {
	                   //   required: true
	                   // }
	                },
	                submitHandler: function()
	                {
	                    var obj = $(".kulliyyah-finder");
	                    if(!obj.hasClass("disabled"))
	                    {
	                        obj.addClass("disabled");
	                        var serializeData = obj.serialize();

	                        canceling = $.ajax({
			                    type:"POST",
			                    url: "ajax_finder.php",
			                    data: serializeData,			                    	
			                    cache:true,
			                    success:function(html){
		                    		$('.search-result').html(html);
	                                console.log("success ajax");

	                                var oTable = $('#mytable').DataTable({
	                                    "aoColumnDefs": [ 
	                                    	{ "bSortable": false, "aTargets": [ 0,1,2,3 ] },
	                                    ] ,
	                                    responsive: true
	                                });

			                        obj.removeClass("disabled");
			                    }
			                })

	                        keyHeight = $(".key-function").outerHeight();
							$(".dashboard-header").removeClass("init");
							$(".dashboard-desc").fadeOut("slow",function(){
								// Animation complete.
							});

							$(".dashboard-mobile").fadeOut("slow",function(){
								// Animation complete.
							});

							$(".dashboard-header").css("min-height",keyHeight+paddingTop);
							$(".module-1-title").html('<div class="col-md-12"><h1 class="text-center">Hasil Carian Kuliah</h1></div>');
							$(".table-module-1").css({"margin":"25px 0"});
							$(".dashboard-header").animate({height:keyHeight+paddingTop},1000,function(){
								$(".landing-dashboard-wrapper").css("background-image","none");
								$(".landing-info-wrapper").fadeOut("slow",function(){
									// Animation complete.
								});
							});

							obj.removeClass("disabled");
	                        
	                    }else{
	                    	alert("Error");
	                    }

	                }
	            });

	            var canceling;

				$(function(){
					$(".login-form").validate({
						rules:
						{
							"email": {
								required: true
							},
							"password": {
								required: true
							}
						},
						submitHandler: function()
						{
							var obj = $(".login-form");
							if(!obj.hasClass("disabled"))
							{
								obj.addClass("disabled");
								var serializeData = obj.serialize();
								
								canceling = $.ajax({
				                    type:"POST",
				                    url: "ajax_login.php",
				                    data: serializeData,				                    	
				                    cache:true,
				                    success:function(data){
				                    	console.log(data);
				                    	var response = data.split("|");
				                    	
				                    	if(response[0]==1){
											$(".logout_wrapper").show();
											$(".login_wrapper").hide();
											console.log("here");

											if(response[0]==1){
												console.log("here2");
												setTimeout(function() {
													window.location.href = "personal.php";
												}, 500);												
											}
				                        }else if(response[0]==0){
				                        	var validator = $(".login-form").validate();
											validator.showErrors({
											 	"email": "Emel ini masih belum didaftar"
											});
				                        }else if(response[0]==2){
				                        	var validator = $(".login-form").validate();
											validator.showErrors({
											 	"password": "Kata laluan anda tidak benar"
											});
				                        }else{
				                        	
					                    }

				                        obj.removeClass("disabled");
				                    }
				                })
							}
						}
					})
				})

				$(document).on("click", ".org-modal", function(event){
					var userID = $(this).attr("organizerID");

					var obj = $(".org-modal");
					if(!obj.hasClass("disabled"))
					{
						obj.addClass("disabled");
						var serializeData = obj.serialize();

						canceling = $.ajax({
							url:'ajax_data.php',
							method:'POST',
							data: "&userID="+userID,
							success:function(data){

								var response = data.split("|");
								if(response[0]==1){

									$(".orgLink").attr("href","javascript:;");
									$(".orgLink").attr("href","personal.php?userID="+response[1]);

									$(".orgName").empty();
									$(".orgName").html(response[2]);

									$(".profile-image").css('background-image', 'url(' + response[3] + ')');

									$(".orgAddress").empty();
									$(".orgAddress").html(response[4]);

									$(".orgPostcode").empty();
									$(".orgPostcode").html(response[5]);

									$(".orgState").empty();
									$(".orgState").html(response[6]);

									$(".orgPhone").empty();
									$(".orgPhone").html(response[7]);

									$(".orgMailTo").attr("href","javascript:;");
									$(".orgMailTo").attr("href","mailto:"+response[8]);     

									$(".orgEmail").empty();                         
									$(".orgEmail").html(response[8]);

									// $(".orgOtherLink").empty();
									// if(response[9]){
									// 	$(".orgOtherLink").html("<a href='"+response[9]+"' target='_blank'>"+response[9]+"</a>");
									// }

									// if(response[10]||response[11]||response[12]){
									// 	$(".orgLinkTitle").html("Ikuti Penganjur di:");
									// }else{
									// 	$(".orgLinkTitle").empty();
									// }

									// $(".orgFacebookLink").empty();
									// if(response[10]){
									// 	$(".orgFacebookLink").html("<a href='"+response[10]+"' target='_blank'><i class='-square fa fa-2x fa-facebook-square fa-fw'></i></a>");
									// }

									// $(".orgYoutubeLink").empty();
									// if(response[11]){
									// 	$(".orgYoutubeLink").html("<a href='"+response[11]+"' target='_blank'><i class='-play fa fa-2x fa-fw fa-youtube-play'></i></a>");
									// }

									// $(".orgInstagramLink").empty();
									// if(response[12]){
									// 	$(".orgInstagramLink").html("<a href='"+response[12]+"' target='_blank'><i class='fa fa-2x fa-fw fa-instagram'></i></a>");
									// }                             

								}else{

								}

								obj.removeClass("disabled");					
							}

						});
					}else{
						
					}

				});


				$(document).on("click", ".exp-modal", function(event){
					var userID = $(this).attr("expertID");

					var obj = $(".exp-modal");
					if(!obj.hasClass("disabled")){

						obj.addClass("disabled");
						var serializeData = obj.serialize();

						canceling = $.ajax({
							url:'ajax_data.php',
							method:'POST',
							data: "&userID="+userID,
							success:function(data){
							console.log(data);
							var response = data.split("|");
							if(response[0]==1){

								$(".expLink").attr("href","javascript:;");
								$(".expLink").attr("href","personal.php?userID="+response[1]);

								$(".expTitle").empty();
								$(".expTitle").html(response[2]);

								$(".expName").empty();
								$(".expName").html(response[3]);

								$(".profile-image").css('background-image', 'url(' + response[4] + ')');

								$(".expEducation").empty();
								$(".expEducation").html(response[5]);

								$(".expArea").empty();
								$(".expArea").html(response[6]);

								$(".expState").empty();
								$(".expState").html(response[7]);

								// $(".expOtherLink").empty();
								// if(response[8]){
								// $(".expOtherLink").html("<a href='"+response[8]+"' target='_blank'>"+response[8]+"</a>");
								// }

								// if(response[9]||response[10]||response[11]){
								// 	$(".expLinkTitle").html("Ikuti Pendakwah di:");
								// }else{
								// 	$(".expLinkTitle").empty();
								// }

								// $(".expFacebookLink").empty();
								// if(response[9]){
								// 	$(".expFacebookLink").html("<a href='"+response[9]+"' target='_blank'><i class='-square fa fa-2x fa-facebook-square fa-fw'></i></a>");
								// }

								// $(".expYoutubeLink").empty();
								// if(response[10]){
								// 	$(".expYoutubeLink").html("<a href='"+response[10]+"' target='_blank'><i class='-play fa fa-2x fa-fw fa-youtube-play'></i></a>");
								// }

								// $(".expInstagramLink").empty();
								// if(response[11]){
								// 	$(".expInstagramLink").html("<a href='"+response[11]+"' target='_blank'><i class='fa fa-2x fa-fw fa-instagram'></i></a>");
								// }

								$(".expServices").empty();

								var tempLoop = 0;
								var tempDataLoop = 12;
								var totalLoop = response[tempDataLoop];
								if(response[tempDataLoop]!=0){
									console.log(totalLoop);
									while(tempLoop<totalLoop){
										console.log("before: "+tempDataLoop+" "+tempLoop);
										tempDataLoop++;

										if(tempLoop==0){
											$(".expServices").append(response[tempDataLoop]);
										}else{
											$(".expServices").append(", "+response[tempDataLoop]);
										}

										tempLoop++;
										console.log("after: "+tempDataLoop+" "+tempLoop);
									}	
								}else{
									$(".expServices").html("Maaf! Masih belum ditetapkan.");
								}   	                 

							}else{

							}
								obj.removeClass("disabled");
							}

						});
					}else{
						alert("Please Select the Date");
					}

				});

	            initWindowsChange();

				$(window).resize(function(){
					initWindowsChange();
				});


	  		});
		</script>
    </body>
</html>

